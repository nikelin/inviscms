# Описание #

Текущая версия системы использует в качестве движка для работы с БД - средства СУБД **MySQL**, которые поставляются в систему пакетом `*database*`.
Так как предполагается, что система должна использовать большее количество платформы, нежели одну **MySQL**, пакет поставляется вместе с абстракцией, которая может служить для создания дополнительных драйверов, под определённые, необходимые разработчикам системы.

Пакет `*database*` предоставляет стандартные методы, для извлечения, проверки и внесение изменений в информацию храниму в базе данных:

```
БазаДанных:{
  Поля:{
     идентификатор_соединения:ОбъектДрайвера,
     последний_запрос:Строка,
     последний_результат:Строка,
     количество_запросов:ЦелоеЧисло,
     последняя_ошибка:Строка,
     массив_ошибок:Массив
  },
  Методы:{

     @Публичные:
      установить_соединение():Булев,
      установить_параметрическое_соединение(АдресБД:АдресБД):ОбъектДрайвера,
      отправить_запрос(запрос:Строка):Булев,
      результат_запроса(ОбъектДрайвера:ОбъектДрайвера):Хеш,
      число_рядов(ОбъектДрайвера:ОбъектДрайвера):ЦелоеЧисло,
      число_полей(ОбъектДрайвера:ОбъектДрайвера):ЦелоеЧисло,
      таблица_существует(имя_таблицы,[имя_базы]*):Булев,
      обработать_внешние_ключи():Булев,
      поле_существует(поле:Строка,таблица:Строка,[бд:Строка]*):Булев,
      ошибка():Булев,
      текст_последней_ошибки():Булев,
      вставить_новый_ряд(таблица:строка,данные:Массив):Булев,
      обновить_ряд(таблица:строка,изменения:Хеш,условие:Хеш):Булев,
      удалить_ряд(таблица:Строка,условие:Хеш):Булев,
      ряд_существует(таблица:Строка,условие:Хеш):Булев

      @Защищённые:
        [нет]
    }
  }
```
Для авторизации в базе данных, используется объект **АдресБД** и данные,
указываемые в фазе установки системы. После указания данных пользователем, и
проверки их корретности, данные сохраняются в конфигурационный файл пакета `database`,
при этом шифруются симметричным алгоритмом, по уникальному ключу длиной в 16 символов,
который генерируется на стадии установки системы.

Спецификация объекта АдресБД:
```
АдресБД:{
    Поля:{
      хост:Строка,
      порт:ЦелоеЧисло,
      логин:Строка,
      Пароль:Строка,
    },
    Методы:{
      @Публичные
          получить_адрес(тип_результата:('url'|'массив')):(Строка|Массив)
      @Защищённые
          [нет]
    }
}
```

Данные сохраняются в формате XML.


## Синхронизация баз данных. Пакет `DBSync` ##

Во время разработки различных проектов, разработчики сталкиваются с такой проблемой, как синхронизация структуры базы данных, с учётом изменений в неё, с каждой последующей версией системы.

Для автоматизации процесса синхронизированная, командой разработчиков начата работа по созданию механизма контроля версий по отношению к структурам БД, основные положения которой представлены в пакете поставляемом вместе с базовым ядром - `*dbsync*`.

Процесс синхронизации состоит из следующих этапов:

1. Выбор **Источника** и **Цели**
2. Назначение правил (Прим.: действия по отношению в таблицам и их содержимому в базе **Цель**, которые были удалены в базе Источник; и т.д.)
3. Формирование инструкций объявления, на основе данных о расхождении в структурах двух БД:
  1. Проверка списока таблиц (имена таблиц, аттрибуты).
> 2. Проверка структуры таблиц (список, аттрибуты, позиции, данные).
> 3. Создание **SQL**-инструкций, с учётом **п.2**.
4. Создание резервной версии базы **Цель**.
5. Удаление данных из базы **Цель**.
6. Исполнение **SQL**-инструций в контексте базы **Цель**.
7. Вывод результатом обновления, списка обновлений, а так же предложения об откате изменений.

Для создания **SQL**-инструкций, будет произведён анализ двух таблиц на основе положений **п.3** и **п.2**, после чего путём обратного инжениринга созданы инструкции для создания таблиц и добавления в них данных, которые будут соответствовать результатам аналитической обработки.